{"openapi":"3.1.0","info":{"title":"Momo API","description":"Self-hostable AI memory system. REST API for AI memory management.","contact":{"name":"Momo Contributors"},"license":{"name":"MIT","identifier":"MIT"},"version":"1.0.0"},"paths":{"/api/v1/admin/forgetting:run":{"post":{"tags":["admin"],"summary":"`POST /api/v1/admin/forgetting:run`","operationId":"admin.runForgetting","responses":{"200":{"description":"Forgetting cycle completed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgettingRunResponse"}}}}},"security":[{"bearer_auth":[]}]}},"/api/v1/containers/{tag}/graph":{"get":{"tags":["graph"],"summary":"`GET /api/v1/containers/{tag}/graph`","description":"Returns the knowledge graph for all memories within a container.","operationId":"graph.getContainer","parameters":[{"name":"tag","in":"path","description":"Container tag","required":true,"schema":{"type":"string"}},{"name":"maxNodes","in":"query","description":"Maximum number of memory nodes to return (default: 100).","required":false,"schema":{"type":["integer","null"],"format":"int32","minimum":0}}],"responses":{"200":{"description":"Container graph","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GraphResponse"}}}}}}},"/api/v1/conversations:ingest":{"post":{"tags":["conversation"],"summary":"`POST /api/v1/conversations:ingest`","description":"Ingests a conversation, extracts memories via LLM, runs contradiction\ndetection and deduplication, then persists the resulting memories.","operationId":"conversation.ingest","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationIngestRequest"}}},"required":true},"responses":{"200":{"description":"Conversation ingested","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationIngestResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/documents":{"get":{"tags":["documents"],"summary":"`GET /api/v1/documents`","description":"Lists documents with cursor-based pagination. Supports filtering by\n`containerTags` query parameter.","operationId":"documents.list","parameters":[{"name":"containerTags","in":"query","description":"Filter by container tags.","required":false,"schema":{"type":["array","null"],"items":{"type":"string"}}},{"name":"limit","in":"query","description":"Maximum results per page (default 20, max 100).","required":false,"schema":{"type":["integer","null"],"format":"int32","minimum":0}},{"name":"cursor","in":"query","description":"Opaque cursor for pagination.","required":false,"schema":{"type":["string","null"]}}],"responses":{"200":{"description":"Documents listed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListDocumentsResponse"}}}}}},"post":{"tags":["documents"],"summary":"`POST /api/v1/documents`","description":"Creates a new document and queues it for async ingestion.\nReturns 202 Accepted with `documentId` and `ingestionId`.","operationId":"documents.create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDocumentRequest"}}},"required":true},"responses":{"202":{"description":"Document accepted for processing","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDocumentResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/documents/{documentId}":{"get":{"tags":["documents"],"summary":"`GET /api/v1/documents/{documentId}`","description":"Retrieves a full document by ID. Also checks custom_id as fallback.","operationId":"documents.get","parameters":[{"name":"documentId","in":"path","description":"Document ID or custom ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Document found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentResponse"}}}},"404":{"description":"Document not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"delete":{"tags":["documents"],"summary":"`DELETE /api/v1/documents/{documentId}`","description":"Deletes a document by ID. Also tries custom_id as fallback.","operationId":"documents.delete","parameters":[{"name":"documentId","in":"path","description":"Document ID or custom ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Document deleted","content":{"application/json":{"schema":{"type":"object"}}}},"404":{"description":"Document not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"patch":{"tags":["documents"],"summary":"`PATCH /api/v1/documents/{documentId}`","description":"Updates document metadata, title, or container tags.","operationId":"documents.update","parameters":[{"name":"documentId","in":"path","description":"Document ID","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateDocumentRequest"}}},"required":true},"responses":{"200":{"description":"Document updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentResponse"}}}},"404":{"description":"Document not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/documents:batch":{"post":{"tags":["documents"],"summary":"`POST /api/v1/documents:batch`","description":"Creates multiple documents in a single request and queues them for\nasync ingestion. Returns 202 Accepted with an array of\n`{ documentId, ingestionId }` pairs.","operationId":"documents.batch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchCreateDocumentRequest"}}},"required":true},"responses":{"202":{"description":"Batch accepted for processing","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchCreateDocumentResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/documents:upload":{"post":{"tags":["documents"],"summary":"`POST /api/v1/documents:upload`","description":"Accepts a multipart form with a `file` field and optional `containerTag`.\nCreates a document from the uploaded file and queues it for async ingestion.\nReturns 202 Accepted with `{ documentId, ingestionId }`.","operationId":"documents.upload","requestBody":{"description":"File upload with optional containerTag and metadata fields","content":{"multipart/form-data":{"schema":{"type":"string"}}},"required":true},"responses":{"202":{"description":"Upload accepted for processing","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDocumentResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/health":{"get":{"tags":["health"],"summary":"`GET /api/v1/health`","operationId":"health.get","responses":{"200":{"description":"Service health status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthData"}}}}}}},"/api/v1/ingestions/{ingestionId}":{"get":{"tags":["documents"],"summary":"`GET /api/v1/ingestions/{ingestionId}`","description":"Polls the ingestion status for a document. Since `ingestionId` maps 1:1\nto `documentId`, this is effectively a status-only document lookup.","operationId":"documents.getIngestionStatus","parameters":[{"name":"ingestionId","in":"path","description":"Ingestion ID (same as document ID)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Ingestion status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestionStatusResponse"}}}},"404":{"description":"Ingestion not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/memories":{"get":{"tags":["memories"],"summary":"`GET /api/v1/memories`","description":"Lists memories with cursor-based pagination. Requires `containerTag` query\nparameter since the DB layer does not support unscoped memory listing.","operationId":"memories.list","parameters":[{"name":"containerTag","in":"query","description":"Filter by container tag.","required":false,"schema":{"type":["string","null"]}},{"name":"limit","in":"query","description":"Maximum results per page (default 20, max 100).","required":false,"schema":{"type":["integer","null"],"format":"int32","minimum":0}},{"name":"cursor","in":"query","description":"Opaque cursor for pagination.","required":false,"schema":{"type":["string","null"]}}],"responses":{"200":{"description":"Memories listed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListMemoriesResponse"}}}},"400":{"description":"Missing containerTag","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"post":{"tags":["memories"],"summary":"`POST /api/v1/memories`","operationId":"memories.create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateMemoryRequest"}}},"required":true},"responses":{"201":{"description":"Memory created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/memories/{memoryId}":{"get":{"tags":["memories"],"summary":"`GET /api/v1/memories/{memoryId}`","operationId":"memories.get","parameters":[{"name":"memoryId","in":"path","description":"Memory ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Memory found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryResponse"}}}},"404":{"description":"Memory not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"delete":{"tags":["memories"],"summary":"`DELETE /api/v1/memories/{memoryId}`","operationId":"memories.forgetById","parameters":[{"name":"memoryId","in":"path","description":"Memory ID","required":true,"schema":{"type":"string"}}],"requestBody":{"description":"Optional reason for deletion","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgetMemoryRequest"}}},"required":true},"responses":{"200":{"description":"Memory forgotten","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgetMemoryResponse"}}}},"404":{"description":"Memory not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}},"patch":{"tags":["memories"],"summary":"`PATCH /api/v1/memories/{memoryId}`","operationId":"memories.update","parameters":[{"name":"memoryId","in":"path","description":"Memory ID","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateMemoryRequest"}}},"required":true},"responses":{"200":{"description":"Memory updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateMemoryResponse"}}}},"404":{"description":"Memory not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/memories/{memoryId}/graph":{"get":{"tags":["graph"],"summary":"`GET /api/v1/memories/{memoryId}/graph`","description":"Returns the knowledge graph neighborhood around a specific memory.","operationId":"graph.getMemory","parameters":[{"name":"memoryId","in":"path","description":"Memory ID","required":true,"schema":{"type":"string"}},{"name":"depth","in":"query","description":"Number of hops to traverse (default: 2).","required":false,"schema":{"type":["integer","null"],"format":"int32","minimum":0}},{"name":"maxNodes","in":"query","description":"Maximum number of memory nodes to return (default: 50).","required":false,"schema":{"type":["integer","null"],"format":"int32","minimum":0}},{"name":"relationTypes","in":"query","description":"Comma-separated edge types to include (e.g. \"updates,relatesto\").","required":false,"schema":{"type":["string","null"]}}],"responses":{"200":{"description":"Graph neighborhood","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GraphResponse"}}}},"404":{"description":"Memory not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/memories:forget":{"post":{"tags":["memories"],"summary":"`POST /api/v1/memories:forget`","description":"Content-based forget: finds a memory by content within a container and\nmarks it as forgotten.","operationId":"memories.forget","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContentForgetRequest"}}},"required":true},"responses":{"200":{"description":"Memory forgotten","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgetMemoryResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/profile:compute":{"post":{"tags":["profile"],"summary":"`POST /api/v1/profile:compute`","description":"Computes or retrieves a user profile from accumulated memories.\nUses the full `MemoryService::get_profile` pipeline (narrative generation,\ncompaction, search) and then maps the resulting `UserProfile` into the\nv1 `ProfileResponse` DTO.","operationId":"profile.compute","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComputeProfileRequest"}}},"required":true},"responses":{"200":{"description":"Profile computed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}},"/api/v1/search":{"post":{"tags":["search"],"summary":"`POST /api/v1/search`","description":"Unified search endpoint. Uses `scope` to determine which indices to query:\n- `documents` → document chunk search\n- `memories` → memory-only search\n- `hybrid` (default) → both documents and memories, deduplicated","operationId":"search.search","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchRequest"}}},"required":true},"responses":{"200":{"description":"Search results","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchResponse"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiError"}}}}}}}},"components":{"schemas":{"ApiError":{"type":"object","description":"Structured error payload within the API envelope.\n\n```json\n{ \"code\": \"not_found\", \"message\": \"Memory mem_abc123 not found\" }\n```","required":["code","message"],"properties":{"code":{"$ref":"#/components/schemas/ErrorCode","description":"Machine-readable error classification."},"message":{"type":"string","description":"Human-readable description safe to display to end users.\nInternal implementation details are never included."}}},"BatchCreateDocumentRequest":{"type":"object","description":"Request body for `POST /v1/documents/batch`.\n\nCreates multiple documents in a single request.","required":["documents","metadata"],"properties":{"containerTag":{"type":["string","null"],"description":"Default container tag applied to all documents in the batch."},"documents":{"type":"array","items":{"$ref":"#/components/schemas/BatchDocumentItem"},"description":"List of documents to create (1–600 items)."},"metadata":{"type":"object","description":"Default metadata applied to all documents in the batch."}}},"BatchCreateDocumentResponse":{"type":"object","description":"Response body for `POST /v1/documents/batch`.","required":["documents"],"properties":{"documents":{"type":"array","items":{"$ref":"#/components/schemas/CreateDocumentResponse"},"description":"Results for each document in the batch, in order."}}},"BatchDocumentItem":{"type":"object","description":"A single document within a batch create request.","required":["content","metadata"],"properties":{"content":{"type":"string","description":"The document content."},"customId":{"type":["string","null"],"description":"Client-provided identifier for this document."},"extractMemories":{"type":["boolean","null"],"description":"When `true`, extract memories from this document after processing."},"metadata":{"type":"object","description":"Metadata specific to this document (overrides batch-level metadata)."}}},"ChunkResult":{"type":"object","description":"A chunk within a document search result.","required":["content","score"],"properties":{"content":{"type":"string"},"rerankScore":{"type":["number","null"],"format":"float"},"score":{"type":"number","format":"float"}}},"ComputeProfileRequest":{"type":"object","description":"Request body for `POST /v1/profile`.","required":["containerTag"],"properties":{"containerTag":{"type":"string","description":"Container tag identifying the user/entity."},"generateNarrative":{"type":["boolean","null"],"description":"Generate a narrative summary."},"includeDynamic":{"type":["boolean","null"],"description":"Include dynamic (episode-based) facts."},"limit":{"type":["integer","null"],"format":"int32","description":"Maximum number of facts to include.","minimum":0},"q":{"type":["string","null"],"description":"Optional search query to filter relevant facts."},"threshold":{"type":["number","null"],"format":"float","description":"Minimum similarity threshold for query-based filtering."}}},"ContentForgetRequest":{"type":"object","description":"Request body for `POST /v1/memories:forget` (content-based forget).","required":["content","containerTag"],"properties":{"containerTag":{"type":"string","description":"Container tag to scope the search."},"content":{"type":"string","description":"The memory content to search for and forget."},"reason":{"type":["string","null"],"description":"Reason for forgetting (stored for audit trail)."}}},"ConversationIngestRequest":{"type":"object","description":"Request body for `POST /v1/conversation`.\n\nIngests a conversation and extracts memories from it.","required":["messages","containerTag"],"properties":{"containerTag":{"type":"string","description":"Container tag for multi-tenant isolation."},"memoryType":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/V1MemoryType","description":"Memory type to assign to extracted memories."}]},"messages":{"type":"array","items":{"$ref":"#/components/schemas/ConversationMessageDto"},"description":"Conversation messages to process."},"sessionId":{"type":["string","null"],"description":"Session ID for grouping related conversations."}}},"ConversationIngestResponse":{"type":"object","description":"Response for `POST /v1/conversation`.","required":["memoriesExtracted","memoryIds","sessionId"],"properties":{"memoriesExtracted":{"type":"integer","format":"int32","description":"Number of memories extracted from the conversation."},"memoryIds":{"type":"array","items":{"type":"string"},"description":"IDs of the extracted memories."},"sessionId":{"type":"string","description":"Session ID (generated if not provided in request)."}}},"ConversationMessageDto":{"type":"object","description":"A single message within a conversation.","required":["role","content"],"properties":{"content":{"type":"string","description":"Message content text."},"role":{"type":"string","description":"Message role (e.g. `\"user\"`, `\"assistant\"`, `\"system\"`)."},"timestamp":{"type":["string","null"],"description":"When this message was sent."}}},"CreateDocumentRequest":{"type":"object","description":"Request body for `POST /v1/documents`.\n\nCreates a new document and queues it for async ingestion.","required":["content","metadata"],"properties":{"containerTag":{"type":["string","null"],"description":"Optional container tag for multi-tenant isolation."},"content":{"type":"string","description":"The document content (text, URL, or base64-encoded file)."},"contentType":{"type":["string","null"],"description":"Content type hint for base64-encoded files (e.g. `\"pdf\"`, `\"docx\"`)."},"customId":{"type":["string","null"],"description":"Client-provided identifier for idempotency or external linking."},"extractMemories":{"type":["boolean","null"],"description":"When `true`, extract memories from document content after processing."},"metadata":{"type":"object","description":"Arbitrary key-value metadata attached to the document."}}},"CreateDocumentResponse":{"type":"object","description":"Response body for `POST /v1/documents` — async ingestion accepted.\n\nWire format:\n```json\n{ \"documentId\": \"V1StGXR8_Z5jdHi6B-myT\", \"ingestionId\": \"550e8400-...\" }\n```","required":["documentId","ingestionId"],"properties":{"documentId":{"type":"string","description":"The assigned document ID (nanoid, 21 chars)."},"ingestionId":{"type":"string","description":"The ingestion tracking ID (UUID v4)."}}},"CreateMemoryRequest":{"type":"object","description":"Request body for `POST /v1/memories`.","required":["content","containerTag","metadata"],"properties":{"containerTag":{"type":"string","description":"Container tag for multi-tenant isolation."},"content":{"type":"string","description":"The memory content text."},"memoryType":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/V1MemoryType","description":"Memory type classification."}]},"metadata":{"type":"object","description":"Arbitrary key-value metadata."}}},"CursorPagination":{"type":"object","description":"Cursor-based pagination parameters accepted by list endpoints.\n\n- `limit` defaults to 20 and is clamped to `1..=100`.\n- `cursor` is an opaque base64 string from a previous `ResponseMeta.nextCursor`.\n  Passing an invalid cursor returns `400 invalid_request`.","properties":{"cursor":{"type":["string","null"],"description":"Opaque pagination cursor from a previous response."},"limit":{"type":"integer","format":"int32","description":"Maximum number of items to return. Clamped to `1..=100`, defaults to 20.","minimum":0}}},"DatabaseStatus":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}}},"DocumentResponse":{"type":"object","description":"Full document response for `GET /v1/documents/{documentId}`.","required":["documentId","docType","ingestionStatus","metadata","containerTags","chunkCount","createdAt","updatedAt"],"properties":{"chunkCount":{"type":"integer","format":"int32","description":"Number of chunks created from this document."},"containerTags":{"type":"array","items":{"type":"string"},"description":"Container tags for multi-tenant isolation."},"content":{"type":["string","null"],"description":"Document content."},"createdAt":{"type":"string","description":"When the document was created."},"customId":{"type":["string","null"],"description":"Client-provided identifier."},"docType":{"$ref":"#/components/schemas/V1DocumentType","description":"Document type classification."},"documentId":{"type":"string","description":"Unique document ID (nanoid, 21 chars)."},"errorMessage":{"type":["string","null"],"description":"Error message if ingestion failed."},"ingestionStatus":{"$ref":"#/components/schemas/IngestionStatus","description":"Current ingestion status."},"metadata":{"type":"object","description":"Attached metadata."},"summary":{"type":["string","null"],"description":"Auto-generated summary."},"title":{"type":["string","null"],"description":"Document title (may be auto-extracted)."},"updatedAt":{"type":"string","description":"When the document was last updated."},"url":{"type":["string","null"],"description":"Source URL (if document was fetched from a URL)."}}},"DocumentSearchResult":{"type":"object","description":"Document match within search results.","required":["documentId","score","metadata","createdAt","updatedAt"],"properties":{"chunks":{"type":"array","items":{"$ref":"#/components/schemas/ChunkResult"},"description":"Matched chunks (if `include.chunks` was true)."},"content":{"type":["string","null"]},"createdAt":{"type":"string"},"docType":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/V1DocumentType"}]},"documentId":{"type":"string","description":"The matched document ID."},"metadata":{"type":"object"},"rerankScore":{"type":["number","null"],"format":"float","description":"Reranking score (if reranking was applied)."},"score":{"type":"number","format":"float","description":"Vector similarity score."},"summary":{"type":["string","null"]},"title":{"type":["string","null"]},"updatedAt":{"type":"string"}}},"DocumentSummaryResponse":{"type":"object","description":"Summary document for list responses — lighter than full `DocumentResponse`.","required":["documentId","docType","ingestionStatus","metadata","containerTags","createdAt","updatedAt"],"properties":{"containerTags":{"type":"array","items":{"type":"string"},"description":"Container tags."},"createdAt":{"type":"string","description":"When the document was created."},"customId":{"type":["string","null"],"description":"Client-provided identifier."},"docType":{"$ref":"#/components/schemas/V1DocumentType","description":"Document type."},"documentId":{"type":"string","description":"Unique document ID."},"ingestionStatus":{"$ref":"#/components/schemas/IngestionStatus","description":"Current ingestion status."},"metadata":{"type":"object","description":"Attached metadata."},"title":{"type":["string","null"],"description":"Document title."},"updatedAt":{"type":"string","description":"When the document was last updated."}}},"EmbeddingsStatus":{"type":"object","required":["status","model","dimensions"],"properties":{"dimensions":{"type":"integer","minimum":0},"model":{"type":"string"},"status":{"type":"string"}}},"ErrorCode":{"type":"string","description":"Machine-readable error code included in every error response.\n\nSerialized as a snake_case string on the wire (e.g. `\"invalid_request\"`).\nEach variant maps to a fixed HTTP status code via [`ErrorCode::status`].","enum":["invalid_request","unauthorized","not_found","conflict","internal_error","not_implemented"]},"ForgetMemoryRequest":{"type":"object","description":"Request body for `DELETE /v1/memories/{memoryId}`.","properties":{"reason":{"type":["string","null"],"description":"Reason for forgetting (stored for audit trail)."}}},"ForgetMemoryResponse":{"type":"object","description":"Response for `DELETE /v1/memories/{memoryId}`.","required":["memoryId","forgotten"],"properties":{"forgotten":{"type":"boolean","description":"Whether the memory was successfully forgotten."},"memoryId":{"type":"string","description":"The memory ID that was forgotten."}}},"ForgettingRunResponse":{"type":"object","description":"Response for `POST /v1/admin/run-forgetting`.","required":["memoriesForgotten","memoriesEvaluated"],"properties":{"memoriesEvaluated":{"type":"integer","format":"int32","description":"Number of memories evaluated for forgetting.","minimum":0},"memoriesForgotten":{"type":"integer","format":"int32","description":"Number of memories forgotten in this cycle.","minimum":0}}},"GraphEdgeResponse":{"type":"object","description":"An edge (link) in the knowledge graph response.","required":["source","target","type"],"properties":{"source":{"type":"string","description":"Source node ID."},"target":{"type":"string","description":"Target node ID."},"type":{"$ref":"#/components/schemas/GraphEdgeType","description":"Relationship type."}}},"GraphEdgeType":{"type":"string","description":"Edge type in the knowledge graph.\n\nWire format: lowercase string.","enum":["updates","relatesTo","conflictsWith","derivedFrom","sources"]},"GraphNodeResponse":{"type":"object","description":"A node in the knowledge graph response.","required":["id","type","metadata"],"properties":{"id":{"type":"string","description":"Node identifier (memory ID or document ID)."},"metadata":{"type":"object","description":"Additional visualization metadata."},"type":{"$ref":"#/components/schemas/GraphNodeType","description":"Node classification."}}},"GraphNodeType":{"type":"string","description":"Node type in the knowledge graph.\n\nWire format: `\"memory\"` or `\"document\"`.","enum":["memory","document"]},"GraphResponse":{"type":"object","description":"Graph response for `GET /v1/memories/{memoryId}/graph` and `GET /v1/containers/{tag}/graph`.","required":["nodes","links"],"properties":{"links":{"type":"array","items":{"$ref":"#/components/schemas/GraphEdgeResponse"},"description":"Graph edges (links between nodes)."},"nodes":{"type":"array","items":{"$ref":"#/components/schemas/GraphNodeResponse"},"description":"Graph nodes."}}},"HealthData":{"type":"object","description":"Health data returned inside the v1 envelope.","required":["status","version","database","embeddings","llm","reranker"],"properties":{"database":{"$ref":"#/components/schemas/DatabaseStatus"},"embeddings":{"$ref":"#/components/schemas/EmbeddingsStatus"},"llm":{"$ref":"#/components/schemas/LlmStatus"},"reranker":{"$ref":"#/components/schemas/RerankerStatus"},"status":{"type":"string"},"version":{"type":"string"}}},"HybridSearchResultResponse":{"type":"object","description":"Hybrid search result — can represent either a memory or a chunk.","required":["id","similarity","metadata","updatedAt"],"properties":{"chunk":{"type":["string","null"]},"documentId":{"type":["string","null"]},"id":{"type":"string"},"memory":{"type":["string","null"]},"metadata":{"type":"object"},"rerankScore":{"type":["number","null"],"format":"float"},"similarity":{"type":"number","format":"float"},"updatedAt":{"type":"string"}}},"IngestionStatus":{"type":"string","description":"Simplified ingestion status for v1 API.\n\nMaps from the internal `ProcessingStatus` (which has many intermediate\nstates) to four user-facing states.\n\nWire format: `\"queued\"`, `\"processing\"`, `\"completed\"`, or `\"failed\"`.","enum":["queued","processing","completed","failed"]},"IngestionStatusResponse":{"type":"object","description":"Ingestion status for a single document (used in status polling).","required":["documentId","status","createdAt"],"properties":{"createdAt":{"type":"string","description":"When the document was created."},"documentId":{"type":"string","description":"Document ID."},"status":{"$ref":"#/components/schemas/IngestionStatus","description":"Current ingestion status."},"title":{"type":["string","null"],"description":"Document title (if available)."}}},"ListDocumentsQuery":{"type":"object","description":"Query parameters for `GET /v1/documents` (list endpoint).","properties":{"containerTags":{"type":["array","null"],"items":{"type":"string"},"description":"Filter by container tags."},"cursor":{"type":["string","null"],"description":"Opaque cursor for pagination."},"limit":{"type":["integer","null"],"format":"int32","description":"Maximum results per page (default 20, max 100).","minimum":0}}},"ListDocumentsResponse":{"type":"object","description":"Response wrapper for document list endpoints.\n\nPagination is handled by the envelope's `meta.nextCursor` / `meta.total`.","required":["documents"],"properties":{"documents":{"type":"array","items":{"$ref":"#/components/schemas/DocumentSummaryResponse"},"description":"Documents matching the query."}}},"ListMemoriesQuery":{"type":"object","description":"Query parameters for `GET /v1/memories`.","properties":{"containerTag":{"type":["string","null"],"description":"Filter by container tag."},"cursor":{"type":["string","null"],"description":"Opaque cursor for pagination."},"limit":{"type":["integer","null"],"format":"int32","description":"Maximum results per page (default 20, max 100).","minimum":0}}},"ListMemoriesResponse":{"type":"object","description":"Memory list response wrapper.\n\nPagination is handled by the envelope's `meta.nextCursor` / `meta.total`.","required":["memories"],"properties":{"memories":{"type":"array","items":{"$ref":"#/components/schemas/MemoryResponse"}}}},"LlmStatus":{"type":"object","required":["status"],"properties":{"model":{"type":["string","null"]},"provider":{"type":["string","null"]},"status":{"type":"string"}}},"MemoryResponse":{"type":"object","description":"Full memory response for `GET /v1/memories/{memoryId}`.","required":["memoryId","content","memoryType","version","isLatest","isInference","isForgotten","isStatic","metadata","createdAt","updatedAt"],"properties":{"confidence":{"type":["number","null"],"format":"double","description":"Confidence score (0.0–1.0)."},"containerTag":{"type":["string","null"],"description":"Container tag."},"content":{"type":"string","description":"The memory content text."},"createdAt":{"type":"string","description":"When the memory was created."},"isForgotten":{"type":"boolean","description":"Whether this memory has been forgotten (soft-deleted)."},"isInference":{"type":"boolean","description":"Whether this memory was derived by inference."},"isLatest":{"type":"boolean","description":"Whether this is the latest version."},"isStatic":{"type":"boolean","description":"Whether this memory is pinned (never auto-forgotten)."},"memoryId":{"type":"string","description":"Unique memory ID (nanoid, 21 chars)."},"memoryType":{"$ref":"#/components/schemas/V1MemoryType","description":"Memory type classification."},"metadata":{"type":"object","description":"Attached metadata."},"updatedAt":{"type":"string","description":"When the memory was last updated."},"version":{"type":"integer","format":"int32","description":"Version number (incremented on contradiction resolution)."}}},"MemorySearchResult":{"type":"object","description":"Memory match within search results.","required":["memoryId","similarity","metadata","updatedAt"],"properties":{"content":{"type":["string","null"]},"memoryId":{"type":"string","description":"The matched memory ID."},"metadata":{"type":"object"},"rerankScore":{"type":["number","null"],"format":"float"},"similarity":{"type":"number","format":"float","description":"Vector similarity score."},"updatedAt":{"type":"string"},"version":{"type":["integer","null"],"format":"int32"}}},"ProfileFactResponse":{"type":"object","description":"A single fact within a profile.","required":["content","createdAt"],"properties":{"confidence":{"type":["number","null"],"format":"double","description":"Confidence score (0.0–1.0)."},"content":{"type":"string","description":"The fact content."},"createdAt":{"type":"string","description":"When this fact was first recorded."}}},"ProfileResponse":{"type":"object","description":"Profile response for `POST /v1/profile`.","required":["containerTag","staticFacts","dynamicFacts","totalMemories","lastUpdated"],"properties":{"containerTag":{"type":"string","description":"Container tag this profile belongs to."},"dynamicFacts":{"type":"array","items":{"$ref":"#/components/schemas/ProfileFactResponse"},"description":"Temporal/episode-based information."},"lastUpdated":{"type":"string","description":"When the profile was last computed."},"narrative":{"type":["string","null"],"description":"AI-generated narrative summary of the user."},"staticFacts":{"type":"array","items":{"$ref":"#/components/schemas/ProfileFactResponse"},"description":"Long-lived factual information."},"totalMemories":{"type":"integer","format":"int32","description":"Total number of memories used to compute this profile."}}},"RerankerStatus":{"type":"object","required":["enabled","status"],"properties":{"enabled":{"type":"boolean"},"model":{"type":["string","null"]},"status":{"type":"string"}}},"ResponseMeta":{"type":"object","description":"Pagination metadata included in list responses.\n\nField names serialize as camelCase on the wire (`nextCursor`, `total`).","properties":{"nextCursor":{"type":["string","null"],"description":"Opaque cursor to pass as `cursor` in the next request. `None` means\nthere are no more results."},"total":{"type":["integer","null"],"format":"int64","description":"Total number of matching items (when cheaply available).","minimum":0}}},"SearchIncludeFlags":{"type":"object","description":"Flags controlling which data to include in search results.","properties":{"chunks":{"type":"boolean","description":"Include individual chunks in document results (default: false)."},"documents":{"type":"boolean","description":"Include document data in results (default: true)."}}},"SearchRequest":{"type":"object","description":"Request body for `POST /v1/search`.","required":["q"],"properties":{"containerTags":{"type":["array","null"],"items":{"type":"string"},"description":"Filter by container tags."},"include":{"$ref":"#/components/schemas/SearchIncludeFlags","description":"Which data to include in results."},"limit":{"type":["integer","null"],"format":"int32","description":"Maximum number of results to return.","minimum":0},"q":{"type":"string","description":"The search query string."},"rerank":{"type":["boolean","null"],"description":"Enable cross-encoder reranking."},"scope":{"$ref":"#/components/schemas/SearchScope","description":"Which indices to search."},"threshold":{"type":["number","null"],"format":"float","description":"Minimum similarity threshold (0.0–1.0)."}}},"SearchResponse":{"type":"object","description":"Unified search response for `POST /v1/search`.","required":["results","total","timingMs"],"properties":{"results":{"type":"array","items":{"$ref":"#/components/schemas/SearchResultItem"},"description":"Combined search results (documents and/or memories based on scope)."},"timingMs":{"type":"integer","format":"int64","description":"Query execution time in milliseconds.","minimum":0},"total":{"type":"integer","format":"int32","description":"Total number of matching results.","minimum":0}}},"SearchResultItem":{"oneOf":[{"allOf":[{"$ref":"#/components/schemas/DocumentSearchResult","description":"A document search result."},{"type":"object","required":["type"],"properties":{"type":{"type":"string","enum":["document"]}}}],"description":"A document search result."},{"allOf":[{"$ref":"#/components/schemas/MemorySearchResult","description":"A memory search result."},{"type":"object","required":["type"],"properties":{"type":{"type":"string","enum":["memory"]}}}],"description":"A memory search result."}],"description":"A single item in the search results — can be a document or memory hit."},"SearchScope":{"type":"string","description":"Search scope determines which indices to query.\n\nWire format: `\"documents\"`, `\"memories\"`, or `\"hybrid\"`.","enum":["documents","memories","hybrid"]},"UpdateDocumentRequest":{"type":"object","description":"Request body for `PATCH /v1/documents/{documentId}`.","required":["metadata"],"properties":{"containerTags":{"type":["array","null"],"items":{"type":"string"},"description":"Updated container tags."},"metadata":{"type":"object","description":"Updated metadata (replaces existing metadata)."},"title":{"type":["string","null"],"description":"Updated document title."}}},"UpdateMemoryRequest":{"type":"object","description":"Request body for `PATCH /v1/memories/{memoryId}`.","required":["content","metadata"],"properties":{"content":{"type":"string","description":"The new memory content (replaces existing)."},"isStatic":{"type":["boolean","null"],"description":"Pin this memory so it's never forgotten."},"metadata":{"type":"object","description":"Arbitrary metadata update."}}},"UpdateMemoryResponse":{"type":"object","description":"Response for `PATCH /v1/memories/{memoryId}`.","required":["memoryId","content","version","createdAt"],"properties":{"content":{"type":"string","description":"The updated content."},"createdAt":{"type":"string","description":"When the update was created."},"memoryId":{"type":"string","description":"The memory ID."},"parentMemoryId":{"type":["string","null"],"description":"Parent memory ID (if this is an update to a previous version)."},"version":{"type":"integer","format":"int32","description":"The new version number."}}},"V1DocumentType":{"type":"string","description":"Document type classification for v1 API.\n\nWire format: lowercase string (e.g. `\"text\"`, `\"pdf\"`, `\"webpage\"`).","enum":["text","pdf","webpage","image","video","audio","markdown","code","csv","docx","pptx","xlsx","unknown"]},"V1MemoryType":{"type":"string","description":"Memory type classification for v1 API.\n\nWire format: lowercase string (`\"fact\"`, `\"preference\"`, `\"episode\"`).","enum":["fact","preference","episode"]}},"securitySchemes":{"bearer_auth":{"type":"http","scheme":"bearer"}}},"security":[{"bearer_auth":[]}],"tags":[{"name":"health","description":"Health check"},{"name":"documents","description":"Document ingestion, CRUD, and listing"},{"name":"search","description":"Unified search across documents and memories"},{"name":"memories","description":"Memory CRUD, listing, and forgetting"},{"name":"graph","description":"Knowledge graph exploration"},{"name":"profile","description":"User profile computation"},{"name":"conversation","description":"Conversation ingestion and memory extraction"},{"name":"admin","description":"Administrative operations (auth required)"}]}